{% extends "public/templates/public_template.html" %} {% block title %}Home{%
endblock %} {% block main %}
<div class="container">
  <div>
    <h1 class="pt-5 mt-5">Music Genre Classification</h1>
    <h4 class="subtitle-sm">
      By Ben, Caio, Patrick, Renay, Walter @ Western University
    </h4>
    <h3 class="subtitle">A <a href="#">WesternAI</a> Project - Fall 2020</h3>
    <button>Repository</button>
  </div>
  <div>
    <h2>The Model</h2>
    <p>
      Our model uses a neural network to classify songs into genres with 68%
      accuracy.
    </p>
    <form action="" method="POST" enctype="multipart/form-data">
      <div class="form-group">
        <label>Select File</label>
        <div class="custom-file">
          <input
            type="file"
            class="custom-file-input"
            name="audio_file"
            id="audio_file"
            accept="audio/*"
          />
          <label class="custom-file-label" for="image"
            >Select .MP3 or .WAV file...</label
          >
        </div>
      </div>

      <button type="submit" class="btn btn-primary">Upload file</button>
    </form>
    <td></td>
    {% if not error %} {% if input %}
    <p>
      According to our model, your song “{{filename}}” is a
      <b>{{ prediction }}</b> song!
      <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
      <script>
        var tensorflow = (async function () {
                console.log("Loading Tensorflow JS Model");
                const model = await tf.loadLayersModel("/static/model.json");
                const classes = [
                  "blues",
                  "classical",
                  "country",
                  "disco",
                  "hiphop",
                  "jazz",
                  "metal",
                  "pop",
                  "reggae",
                  "rock",
                ];
                console.log("Predicting");
                const prediction = model
                  .predict(
                    tf.tensor({{input}})
                  )
                  .argMax()
                  .dataSync()[0];
                console.log(classes[prediction]);
              })();
      </script>
    </p>
    {% endif %} {% else %}
    <p>{{error}}</p>
    {% endif %}
  </div>
  <div>
    <h2>The Architecture</h2>
    <p>
      After building different types of models, including KNN, we decided to go
      with an Artificial Neural Network, as we were able to achieve good
      accuracy with it.
    </p>
    <div class="row">
      <div class="col-sm-8 offset-sm-2">
        <img src="/static/nn.png" class="img-fluid mx-auto mt-3" />
      </div>
    </div>
  </div>
  <div>
    <h2>The Project</h2>
    <p>
      This project is part of the WesternAI FW’21 Gideon cohort. Gideon teams
      work collaboratively with 3-5 other members of Western AI to tackle an AI
      project of their choosing.
    </p>
    <div class="row">
      <div class="col">
        <h4>1. Lessons</h4>
        <p>
          First, the team worked through a Lesson Plan involving Neural
          Networks, Numpy, Pandas, Keras and Flask.
        </p>
      </div>
      <div class="col">
        <h4>2. Model Creation</h4>
        <p>
          Once we decided on the project topic, we built and improved models
          until we had a satisfactory one. Our initial approach was a KNN model,
          but we later saw that Neural Networks worked better.
        </p>
      </div>
      <div class="col">
        <h4>3. Web App</h4>
        <p>
          Lastly, we created this website to display our model and allow other
          people to use it!
        </p>
      </div>
    </div>
  </div>
  <div>
    <h2>The Team</h2>
    <div class="row">
      <div class="col">
        <img />
        <h4>Person A</h4>
        <p>Program</p>
        <p>Year</p>
        <p>Role</p>
        <a href="#">GitHub</a>
        <a href="#">Linkedin</a>
      </div>
      <div class="col">
        <img />
        <h4>Person A</h4>
        <p>Program</p>
        <p>Year</p>
        <p>Role</p>
        <a href="#">GitHub</a>
        <a href="#">Linkedin</a>
      </div>
      <div class="col">
        <img />
        <h4>Person A</h4>
        <p>Program</p>
        <p>Year</p>
        <p>Role</p>
        <a href="#">GitHub</a>
        <a href="#">Linkedin</a>
      </div>
      <div class="col">
        <img />
        <h4>Person A</h4>
        <p>Program</p>
        <p>Year</p>
        <p>Role</p>
        <a href="#">GitHub</a>
        <a href="#">Linkedin</a>
      </div>
    </div>
  </div>
</div>
<footer class="footer">
  <div class="container text-center">
    <p class="mb-2">WesternAI Gideon Project Submission</p>
    <p class="mb-2">By Ben, Caio, Patric, Renay, Walter - 2020</p>
    <a class="mb-2" href="">GitHub Repository</a>
  </div>
</footer>
{% endblock %}
